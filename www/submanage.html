<!DOCTYPE html>
<html lang="kor" dir="ltr">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="./static/css/common/base.css" type="text/css" />
    <link rel="stylesheet" href="./static/css/common/manage.css" type="text/css" />
    <link rel="stylesheet" href="./static/css/common/header.css" type="text/css" />
    <link rel="stylesheet" href="./static/css/common/footer.css" type="text/css" />
    <link rel="stylesheet" href="./static/css/common/modal.css" type="text/css" />

    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="js/DIS.Web.Common.js"></script>
    <script type="text/javascript" src="js/DIS.Web.Init.js"></script>
    <script type="text/javascript" src="js/DIS.Web.SubAccount.js"></script>
    <script src="./static/js/sweetalert/sweetalert.js"></script>
    <script src="./static/js/common/common.js"></script>
    <script src="./static/js/common/header.js"></script>
    <style>
        .swal2-actions {
          margin: 0 !important;
        }
    </style>
</head>

<body>
    <div class="header">
        <div class="header_content">
            <div class="logo">
                <a href="/main">
                    <img src="./static/imgs/common/new_header_logo.png">
                </a>
            </div>
            <div class="flow">
            </div>
            <div class="login_user">
            </div>
            <div class="menuBtn">
                <img class="menu_nohover" src="./static/imgs/common/header_menu.png">
            <img class="menu_hover" src="./static/imgs/common/header_menu_hover.png">
                <div id="myDropdown" class="dropdown-content">
                    <a href="/main">홈</a>
                    <a href="/encrypt/log">비식별화 기록 열람</a>
                    <a href="/decrypt/log">복호화 기록 열람</a>
                    <a href="/usage">사용량 조회</a>
                    <a href="/key">KEY 관리</a>
                    <a class="infoMove">내 정보</a>
                    <a class="admin_only" href="/submanage">서브 계정 관리</a>
                    <div id="logout">로그아웃</div>
                </div>
            </div>
        </div>
    </div>
    <div class="sub_content">
        <div class="subHeader">
            <div class="subkey_modi">
                <p>접속 키 설정</p>
            </div>
            <div class="sub_add">
                <p>서브 계정 생성</p>
            </div>
        </div>
        <div class="sub_table">
            <div class="subList">
                <div class="listHeader">
                    <div class="headArea">
                        <div class="number_head">
                            <h3>No</h3>
                        </div>
                        <div class="id_head">
                            <h3>ID</h3>
                        </div>
                        <div class="name_head">
                            <h3>이름</h3>
                        </div>
                        <div class="last_head">
                            <h3>최종 접속일</h3>
                        </div>
                        <div class="create_head">
                            <h3>계정 생성일</h3>
                        </div>
                        <div class="pass_head">
                            <h3>비밀번호 재설정</h3>
                        </div>
                        <div class="auth_head">
                            <h3>권한 재설정</h3>
                        </div>
                        <div class="del_head">
                            <h3>삭제하기</h3>
                        </div>
                    </div>
                </div>
                <div class="listContent">
                </div>
            </div>
        </div>
    </div>
    <div class="footer">
        <div class="logo">
            <img src="./static/imgs/common/new_footer_logo.png">
            <div class="upBtn">
              <img src="./static/imgs/common/upBtn_icon.png">
            </div>
        </div>
        <div class="textArea">
            <div class="footer_menu">
                <label>개인정보처리방침</label>
                <p>|</p>
                <label>서비스이용약관</label>
                <p>|</p>
                <label>이메일무단수집거부</label>
            </div>
            <div class="companyInfo">
                <div class="loc">
                    <p>[04794] 서울특별시 성동구 아차산로 103 (성수동2가, 영동테크노타워) 609호</p>
                </div>
                <div class="ceo_num">
                    <p class="info">대표 :&nbsp;<label>조판희</label></p>
                    <p>|</p>
                    <p class="info">사업자번호 :&nbsp;<label>120-87-43532</label></p>
                    <p>|</p>
                    <p class="info">통신판매업신고번호 :&nbsp;<label>제0000-서울성동-0000호</label></p>
                </div>
                <div class="call_num">
                    <p class="num">Tel :&nbsp;<label>070-7553-2372</label></p>
                    <p>|</p>
                    <p class="num">Fax :&nbsp;<label>02-2051-2370</label></p>
                </div>
                <div class="inc">
                    <p>(주)엠에이치엔씨티 © mhncity Inc. all rights reserved</p>
                </div>
            </div>
        </div>
    </div>
</body>

<div id="passModi" class="modal">
    <div id="wrap">
        <div class="layerPopupBox active">
            <div class="inner">
                <div class="passContent">
                    <div class="passHeader">
                        <h1>서브 계정 비밀번호 재설정</h1>
                        <h2>서브 계정<br>비밀번호 재설정</h2>
                    </div>
                    <div class="passBody">
                        <div class="bodyHeader">
                            <p>비밀번호</p>
                            <input type="password" class="modi_password" autofocus>
                        </div>
                        <div class="passFooter">
                            <div class="passConfig">
                                <p>확인</p>
                            </div>
                            <div class="cancel">
                                <p>취소</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="subKeyModi" class="modal">
    <div id="wrap">
        <div class="layerPopupBox active">
            <div class="key_inner">
                <div class="keyContent">
                    <div class="keyHeader">
                        <h1>접속 키 설정</h1>
                    </div>
                    <div class="keyBody">
                        <div class="keyArea">
                            <p>접속 키</p>
                            <input class="accessKey" maxlength="20">
                        </div>
                        <div class="keyFooter">
                            <div class="keyConfig">
                                <p>저장</p>
                            </div>
                            <div class="cancel">
                                <p>취소</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="authModi" class="modal">
    <div id="wrap">
        <div class="layerPopupBox active">
            <div class="auth_inner">
                <div class="authContent">
                    <div class="authHeader">
                        <h1>서브 계정 권한 설정</h1>
                        <input class="subid" value="" hidden>
                    </div>
                    <div class="authBody">
                        <div class="authArea">
                            <div class="bucketAuth">
                                <h1>버킷 권한 설정</h1>
                                <div class="selectArea">
                                    <input class="bdownloadAuth" type="checkbox"><label>다운로드</label>
                                    <input class="buploadAuth" type="checkbox"><label>업로드</label>
                                    <input class="bdeleteAuth" type="checkbox"><label>삭제</label>
                                </div>
                            </div>
                            <div class="dbAuth">
                                <h1>DB 권한 설정</h1>
                                <div class="selectArea">
                                    <input class="dcreateAuth" type="checkbox"><label>생성</label>
                                    <input class="dreadAuth" type="checkbox"><label>읽기</label>
                                    <input class="dupdateAuth" type="checkbox"><label>수정</label>
                                    <input class="ddeleteAuth" type="checkbox"><label>삭제</label>
                                </div>
                            </div>
                            <div class="enc_dec_Auth">
                                <h1>암복호화 권한 설정</h1>
                                <div class="selectArea">
                                    <input class="encAuth" type="checkbox"><label>비식별화</label>
                                    <input class="decAuth" type="checkbox"><label>복호화</label>
                                </div>
                            </div>
                        </div>
                        <div class="authFooter">
                            <div class="authConfig">
                                <p>확인</p>
                            </div>
                            <div class="cancel">
                                <p>취소</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="saveConfir" class="modal">
    <div id="wrap">
        <div class="layerPopupBox active">
            <div class="info_inner">
                <div class="saveContent">
                    <div class="saveHeader">
                        <h1>비밀번호 입력</h1>
                    </div>
                    <div class="saveBody">
                        <div class="bodyHeader">
                            <p>현재 비밀번호</p>
                            <input type="password" class="cur_password" autofocus>
                        </div>
                        <div class="saveFooter">
                            <div class="infoConfir">
                                <p>확인</p>
                            </div>
                            <div class="cancel">
                                <p>취소</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $("#subKeyModi").keypress(function (e) {
        if (e.keyCode == 13) {
            $(".keyConfig").click();
        }
    });

    $("#passModi").keypress(function (e) {
        if (e.keyCode == 13) {
            $(".passConfig").click();
        }
    });

    $(document).on("click", ".pass_modi", function () {
        var Idx = $(this).attr('value')

        $(document).on("click", ".passConfig", function () {
            var newPassword = $('.modi_password').val();
            var check_num = /[0-9]/;    // 숫자 
            var check_big = /[A-Z]/;    // 대문자
            var check_small = /[a-z]/;    // 소문자
            var check_symbol = /[\{\}\[\]\/?.,;:|\)*~`!^\-_+<>@\#$%&\\\=\(\'\"]/g; // 특수기호
            if (newPassword == '') {
                Swal.fire({
                    title:'빈 칸에 정보를 입력해주세요.',
                    showConfirmButton:false,
                    showDenyButton:true,
                    denyButtonText:"확 인",
                    icon:"error"
                });
            }
            else if(newPassword.length<8){
                Swal.fire({
                    title: '비밀번호는 8자 이상 입력해주세요.',
                    showConfirmButton:false,
                    showDenyButton:true,
                    denyButtonText:"확 인",
                    icon:"error"
                })
            }
            else if(check_num.test(newPassword)!=true || check_big.test(newPassword)!=true || check_small.test(newPassword)!=true || check_symbol.test(newPassword)!=true){
                Swal.fire({
                    title: '비밀번호는 대문자, 소문자, 숫자, 특수기호를 혼합하여 입력해주세요.',
                    showConfirmButton:false,
                    showDenyButton:true,
                    denyButtonText:"확 인",
                    icon:"error"
                })
            }
            else {
                Swal.fire({
                    title: '입력한 비밀번호로 변경하시겠습니까?',
                    showCancelButton: true,
                    confirmButtonText: '네',
                    cancelButtonText: '취소'
                }).then((result) => {
                    if (result.isConfirmed) {
                        var result = subaccount.resetPassword(Idx, newPassword)
                        if (result) Swal.fire('비밀번호 재설정이 완료되었습니다.', '', 'success').then(() => {
                            location.href = '/submanage';
                        })
                        else Swal.fire(
                            '처리가 완료되지 않았습니다.',
                            '다시 시도해 주세요.',
                            'error'
                        )
                    }
                })
            }
        })
    });

    $(document).on("click", ".delBtn", function () {
        var Idx = $(this).attr('value')

        Swal.fire({
            title: '해당 서브계정을 삭제하시겠습니까?',
            icon: 'info',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            confirmButtonText: '삭제',
            cancelButtonText: '취소'
        }).then((result) => {
            if (result.isConfirmed) {
                var result = subaccount.deleteSubAccount(Idx)
                if (result) Swal.fire('서브계정이 삭제되었습니다.', '', 'success').then(() => {
                    location.href = '/submanage';
                })
                else Swal.fire(
                    '처리가 완료되지 않았습니다.',
                    '다시 시도해 주세요.',
                    'error'
                )
            }
        })
    });
</script>

</html>